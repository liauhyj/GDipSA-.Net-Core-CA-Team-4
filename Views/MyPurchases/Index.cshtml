@{
    ViewData["Title"] = "My Purchases";
    //List<Product> pdtspurchased = (List<Product>)ViewData["pdtspurchased"];
    List<PurchaseDetail> purchases = (List<PurchaseDetail>)ViewData["purchases"];

}

@section Scripts
{
    <script src="~/js/mypurchases/index.js"></script>
}

@{

    //if not purchases made yet
    if (purchases == null)
    {
    <div align="center">
        <span style="font-size:20px">
            You have yet to purchase anything!
            Browse our products <a href="/">here</a> now! :)
        </span>
    </div>

    }

    //have past purchases
    else
    {
    <table align="center">


        @foreach (PurchaseDetail p in purchases)
        {
            var dateFormat = "dd MMM yyyy";
            DateTimeOffset pdatetime = DateTimeOffset.FromUnixTimeSeconds(p.Purchase.Timestamp).ToLocalTime();
            var pdate = pdatetime.ToString(dateFormat);
            <tr>
                <td>
                    <div class="card bg-light m-3" style="float: left; border: 1px solid black; text-align: center; padding: 10px 10px; width: 160px; height: 180px; border-radius:5px;">
                        <div class="card-header">
                            <img src="@p.Product.Image" width="60" /> <br />

                        </div>
                        <div class="card-body">
                            <h5 class="card-title">@p.Product.Name </h5>
                        </div>
                    </div>
                </td>
                <td style="padding-left:30px;">
                    <div style="font-size:12pt;font-style:italic">
                        @p.Product.Description
                    </div>
                    <br />
                    <span style="font-size: 14px; font-weight:bold;">Purchased on:</span>
                    <span id="purchasedate"> @pdate</span>
                    <br />

                    <span style="font-size: 14px; font-weight:bold;">Quantity:</span>
                    <span> @p.Quantity</span>
                    <br />

                    <span style="font-size: 14px; font-weight:bold;">Activation Key:</span>

                    <input list="@(p.ProductId.ToString()+"atvkeys")" name="atvkeys">
                    <datalist id="@(p.ProductId.ToString()+"atvkeys")">
                            @foreach (ActivationKey ak in p.ActivationKeys)
                            {
                                <option value="@ak.PdtAtvKey"></option>
                            }
                    </datalist>
  

                    <br />
                </td>
            </tr>
        }
    </table>

    }
}

